
+++
title = "i18 Challenge - Part 2"
date = "2019-07-17T10:40:00+02:00"
description = "Here is the second part of the i18 CTF with 4 more challenges. This time I learned about Reverse Engineering, DNS lookup, more RE, and finally some steganography that ended up not working."
draft = false
toc = false
categories = ["post"]
tags = ["i18", "ctf", "reverse", "re", "nslookup", "web", "forensic"]
images = [
  "https://brundlelab.files.wordpress.com/2010/09/searchcrypt.png"
] # overrides site-wide open graph image

+++

## 5: Lett fluidmekanikk

<strong>An executable file.<br>
Clue one: The program also accepts the password as an argument.<br>
Clue two: The password exists (perhaps) in a dictionary.</strong>

We get an executable file asking for a password. Enter the wrong one and it quits. I'm a complete beginner in Reverse Engineering but I have enjoyed a few tutorial videos so let's jump right in with Immunity.  
{{< hackcss-alert type="info" >}}
When you open the file, right click > View > module ‘crackme’. Then right click > Search for > All reference text strings. It will show you the lines of text that the software shows us, for example "ASCII "Please enter your password: “”. Double click on this one.
{{< /hackcss-alert >}}

Now the goal is to find a way to bypass the login system. If we check the other strings we can see a password! 

{{< hackcss-alert type="info" >}}
008B161B   . C785 6CFDFFFF 78428C00            MOV DWORD PTR SS:[EBP-294],crackme.008C4>;  ASCII "pAss0rd1337"
{{< /hackcss-alert >}}

If we try it though, the program just trolls us and shows "Good job! Incorrect password, though." before exiting. 

![Hex screen capture](/i18/troll.png)

The important part to look for now are the JNZ:
{{< hackcss-alert type="info" >}}
JNZ - The jump WILL take place if the Z Flag is NOT zero (1)<br>
CMP - If the two values are equal, the Z Flag is set (1) otherwise it is not set (0)
{{< /hackcss-alert >}}

We see several JNZ, and if we check the one right after the fake password trolling, it goes to 008B172B. So this is the exit of the program. What about the correct answer though?

![Hex screen capture](/i18/jump.png)

In this screenshot, we can see that right before the Correct line, we have a jump happening that goes to 008B171E which is the Incorrect option and then the program exit. So by simply replacing the assembly of this jump with JZ, we bypass the verification system as now it will avoid the jump if the password is NOT the right one and give us the Correct answer!

![Hex screen capture](/i18/solved-re.png)

## 6: For the record...

<strong>This is just to look up.<br>
Clue one: For example, in a distributed, hierarchical directory service.<br>
Clue two: challenge.i18.no. CLASS1 TYPE16</strong>

The look up part gave it up kind of for me. I started directly looking for a DNS recon using nslookup:
{{< hackcss-alert type="info" >}}
nslookup challenge.i18.no<br>
Server:		10.11.0.1<br>
Address:	10.11.0.1#53<br><br>

Non-authoritative answer:<br>
Name:	challenge.i18.no<br>
Address: 185.56.186.11<br>
{{< /hackcss-alert >}}

Now I checked all the possible record types: A, MX, and TXT. 

In the TXT records we find the answer!

![nslookup screen capture](/i18/nslookup.png)

## 7: Not quite a 0day

<strong>Another executable file. Apparently vulnerable, by the file name to judge. Hmm.<br>
Clue one: The task can be solved in several ways.<br>
Clue two: Some features of C can make your program vulnerable if you use them incorrectly.<br>
Clue three: Look for square brackets and align in ascending order.</strong>

I spent a long time on this one. I thought it would be another Reverse Engineering job so started to look at the program in Immunity, but for almost 2hrs I couldn't find anything. I checked the first two clues which confused me even more so after another half an hour of googling about C vulnerabilities, I checked the last clue. It said to look for square brackets, so I did just that in Immunity. 

![immunity screen capture](/i18/brackets.png)

Found 13 lines of them and after ordering them, the letters contained in each bracket make up the line “hacktheplanet”.

{{< hackcss-alert type="info" >}}
echo -n hacktheplanet | sha256sum<br>
48f6018bc6898a5c9e61d549b174131c07ed70542ba1c326289b9cc35af22f84
{{< /hackcss-alert >}}

Probably the weirdest challenge so far, very puzzle / CTF-like. 

## 8: På riktig bølgelengde

![nsm logo](/i18/logo.jpg)<br>
<strong>Clue: Things are not always as they appear.</strong>

We just got this image. After doing a little bit of info recon on the file itself, not much comes up except the size of it for such a small image. So that and the clue tells me that something is up.

After a little bit of research, I find <a href="https://ctfs.github.io/resources/topics/steganography/file-in-image/README.html" target="_blank">this useful article</a> about hidden files in images. One important information is that in the HEX, a jpg has the terminating byte of ffd9. If we search for it with: 
{{< hackcss-alert type="info" >}}
cat logo.jpg | grep 'ffd9'
{{< /hackcss-alert >}}
![command line hex grep](/i18/initial-hex.png)

We see that there is still a lot going on after the ffd9 where it should have ended. We have “4944 3303” as the following bytes, and with a quick google search we find out that it is the initial bytes of an MP3 file. Still thanks to the previous article, we know that we can use the dd command to extract it. But first we need to find the offset in an hex editor. I used <a href="http://elinuxbook.com/install-bless-hex-editor-hexadecimal-editor-in-ubuntu-16-04-a-best-hex-editor-for-linux/" target="_blank">Bless Hex Editor</a> which has a nice and simple GUI. I found the offset “0x3BD8” where the MP3 file starts:

![bless hex screenshot](/i18/hex.png)

Still according to the article linked above: “dd only takes decimal values, so we convert the hexadecimal location from <a href="https://www.binaryhexconverter.com/hex-to-decimal-converter" target="_blank">hex to decimal</a>”. Which gives us the decimal 15320. Now we can run the dd command: 

{{< hackcss-alert type="info" >}}
dd if=logo.jpg bs=1 skip=15320 of=logo.mp3
{{< /hackcss-alert >}}

The file is created but after that I have been lost for too long. I can't find a way to make this MP3 work so I gave up for now, and I'll probably come back to this challenge later. If anyone spots an obvious mistake I made, please contact me!

See you for part 3!

![computer gif](/computer.gif)

